(function(e){function n(n){for(var r,i,c=n[0],o=n[1],s=n[2],d=0,_=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&_.push(a[i][0]),a[i]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);u&&u(n);while(_.length)_.shift()();return l.push.apply(l,s||[]),t()}function t(){for(var e,n=0;n<l.length;n++){for(var t=l[n],r=!0,c=1;c<t.length;c++){var o=t[c];0!==a[o]&&(r=!1)}r&&(l.splice(n--,1),e=i(i.s=t[0]))}return e}var r={},a={app:0},l=[];function i(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=r,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)i.d(t,r,function(n){return e[n]}.bind(null,r));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=n,c=c.slice();for(var s=0;s<c.length;s++)n(c[s]);var u=o;l.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"034f":function(e,n,t){"use strict";var r=t("1e1e"),a=t.n(r);a.a},"042c":function(e,n,t){"use strict";var r=t("b4e8"),a=t.n(r);a.a},"1e1e":function(e,n,t){},"2ade":function(e,n,t){"use strict";var r=t("de7f"),a=t.n(r);a.a},"2c1d":function(e,n){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAEY0lEQVRoge2Z304bRxTG9xF4AyyZlj8rjFtU4xrJih2XQGVk2QrJtnLaugGikKp1WgmVRhW+CBctSbhBQUQpqEpIUaTGoLQqClhIKQVLSN144yipqnZmn8CP8PXCXteY3Z3d8TpwwUjf5c5+58zvzM6cFYSTcTKOxyBE9hIiZ1RVWaZU2aa0IFNaKFFaAKUFQqmSpVTJEiJnCJG9R+1XEARBIEQ+RYicqZiFTZVUVZkjRHYdhfEWVVXmajLckFRVWX4tgThtXCeQuaaaL3PsvPE6yYTILU6b95YLsenmq/XhWKFXzDcFGZYaDqKMDdcOA0oLePlq34mV4MOpEeZfvtrHrdt3IY1NIXbhK8zcuo0/n/3BXRO8AWR4jD/MPqoar9ePP61yBaGqyjJH9u1xv7X9BBOTM7rGazUxOYPHv/3CUw+upmRfw+X86NdM87Wyj5WStWreZSX7LFysyg5WllbBSvat4mJVVrGyVAuVk6SjuDiIVYmVfa9ZBpzMupGksSl+jAiR02YPS8lUU81HP/gc8ZELrADShgGULyPGDydiUXS0dyE4cNZx85HhjyCKXiRiURSLu3y7kZUv780b1+FudcHjeQdDI5cbNn4mfhFvvR2ARxRx88Z1hvkCKFW2uQpY08aLHXy7s45w8hzcrS74AhFuXHyBCN50v4Fw8hw+e/QDNl7sWNlOjQuZMo7MC/tPMPk0W9X4vXn0BvttY6Xh4h+MYPze/IE5v8//2rwAMg/vHniZpsS1tCWsNFw6OjuRuJbG1Y0Hh+b65ucl/PWvbBoEF0LF4i4GToeqy60XiBFWerjUP3t14wHOjH+MHlFkrYDx6ZS1CxWLu5i49CncrS5E05d0g6jFyheI4N3g+4a41Brv6OxEIhZFPr/JX8SVC7vpBH/vbSL75Rfoa29Hb7Af52emDLHyD0bgH4wY4pJanEVvsB/hLhELH0r459lTZhGbHicIkT8xe/j50gLyoxexl0xiL5nEdCgMd6vLFCs9aVnvdrdhOhRGTpKqcz5fWjANgBA5YxZAi9nDO+Nj1RdpykkSUr4+U6z0cIl6evD47Mih+X4fG2UFYH5PNtuJekQR06HwoZfuJZNYjcdNsarFZX5oSDcR3703AL/HY/YxY18vzY7Tua019Pf5EO4SsRqP6wZSi1VqcRapxVlDXDQtDQ8j3CVi4HQIK/fvmPHPbnyxMKL0/+PElUBA11AtVt3uNkNccpKEK4EA/B6PpWMEIfIpZgCCwN5OKS0gn9+sbqlGWGkmjXDpdrchEYsit7VmZfex3na0c6lfX1thYsWDS51Ktpu/rC2VBys7uFjeOs2G3caWHlY8uByUst1Qs5dytBY1rLQitolLrUjDnWqeJpemlft3sL62YguXOu4d61A31OTlkNyUPzav5wdHg8yzBqtz0YBKhMjpppqvC8R299rI+FH+rXSVV4TdDDBA5Vj9M24hRE6XL0VKthIUqUimVMlWMn18TJ+MkyEI/wFzEvd6fBEyOgAAAABJRU5ErkJggg=="},"48ac":function(e,n,t){"use strict";var r=t("dc04"),a=t.n(r);a.a},"56d7":function(e,n,t){"use strict";t.r(n);t("e44b"),t("6648"),t("5f54"),t("f0e6");var r=t("0261"),a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("Home")],1)},l=[],i=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("router-view")],1)},c=[],o={name:"Home"},s=o,u=t("e90a"),d=Object(u["a"])(s,i,c,!1,null,"6f8cc9d4",null),h=d.exports,m={name:"app",components:{Home:h}},p=m,f=(t("034f"),Object(u["a"])(p,a,l,!1,null,null,null)),v=f.exports,b=t("a3c5"),g=t.n(b);t("b9b6");r["default"].use(g.a);var y=t("1bee"),w=function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",{attrs:{id:"home"}},[r("Headerbox"),r("el-main",{staticClass:"main"},[r("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[r("el-col",{attrs:{span:6}},[r("router-link",{attrs:{to:"Xingqd"}},[r("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[r("img",{staticClass:"image",attrs:{src:t("c1e1")}}),r("div",{staticClass:"content-title"},[r("span",[e._v("兴趣点")])])])],1)],1),r("el-col",{attrs:{span:6}},[r("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[r("img",{staticClass:"image",attrs:{src:t("decf")},on:{click:e.todatavAliyun}}),r("div",{staticClass:"content-title",on:{click:e.todatavAliyun}},[r("span",[e._v("行政边界")])])])],1),r("el-col",{attrs:{span:6}},[r("router-link",{attrs:{tag:"a",target:"_blank",to:"Subway"}},[r("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[r("img",{staticClass:"image",attrs:{src:t("6fe1")}}),r("div",{staticClass:"content-title"},[r("span",[e._v("地铁线路")])])])],1)],1)],1),r("br"),r("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[r("el-col",{attrs:{span:6}},[r("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[r("img",{staticClass:"image",attrs:{src:t("6fe1")}}),r("div",{staticClass:"content-title"},[r("span",[e._v("坐标拾取器")])])])],1),r("el-col",{attrs:{span:6}},[r("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[r("img",{staticClass:"image",attrs:{src:t("6fe1")}}),r("div",{staticClass:"content-title"},[r("span",[e._v("地理编码")])])])],1),r("el-col",{attrs:{span:6}},[r("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[r("img",{staticClass:"image",attrs:{src:t("6fe1")}}),r("div",{staticClass:"content-title"},[r("span",[e._v("行政边界")])])])],1)],1)],1)],1)},k=[],E={name:"Catalog",methods:{todatavAliyun:function(){window.open("http://datav.aliyun.com/tools/atlas/#&lat=33.521903996156105&lng=104.29849999999999&zoom=4","_blank")}}},x=E,C=(t("cd45"),Object(u["a"])(x,w,k,!1,null,"3ff18b91",null)),P=C.exports,O=function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",[r("Headerbox"),r("el-main",{staticClass:"main"},[r("el-page-header",{attrs:{content:"兴趣点"},on:{back:e.goBack}}),r("div",{staticClass:"itemsName"},[r("img",{attrs:{src:t("2c1d")}}),r("span",[e._v("我的项目("+e._s(e.itemsNum)+")")])]),r("el-button",{staticClass:"addItems",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(n){e.dialogTableVisible=!0}}},[e._v("创建项目")]),r("el-dialog",{attrs:{title:"创建项目",visible:e.dialogTableVisible,"close-on-click-modal":!1},on:{close:e.addDialogClose,"update:visible":function(n){e.dialogTableVisible=n}}},[r("el-form",{ref:"addFormRef",attrs:{rules:e.rulesCreProj,model:e.creProj,"label-width":"100px",size:"mini"}},[r("el-form-item",{staticClass:"big",attrs:{prop:"projname",label:"项目名称："}},[r("el-input",{model:{value:e.creProj.projname,callback:function(n){e.$set(e.creProj,"projname",n)},expression:"creProj.projname"}})],1),r("el-form-item",{staticClass:"big",attrs:{prop:"spidercity",label:"抓取城市："}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("div",{staticClass:"cityLevel"},[e._v("省市区")]),r("el-select",{attrs:{"value-key":"code",placeholder:"请选择"},on:{change:e.search},model:{value:e.creProj.provinceObj,callback:function(n){e.$set(e.creProj,"provinceObj",n)},expression:"creProj.provinceObj"}},e._l(e.provinces,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e}})})),1)],1),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"cityLevel"},[e._v("地级市")]),r("el-select",{attrs:{"value-key":"code",placeholder:"请选择"},on:{change:e.cityChanged},model:{value:e.creProj.cityObj,callback:function(n){e.$set(e.creProj,"cityObj",n)},expression:"creProj.cityObj"}},e._l(e.cities,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{staticClass:"small",attrs:{prop:"spidertype",label:"抓取类型："}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.creProj.spidertype,callback:function(n){e.$set(e.creProj,"spidertype",n)},expression:"creProj.spidertype"}},e._l(e.spiderTypes,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),r("el-form-item",[r("el-button",{on:{click:function(n){e.dialogTableVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.onCreProj}},[e._v("确定")])],1)],1)],1),e.noProj?r("el-col",{attrs:{span:24}},[r("el-card",{attrs:{shadow:"never"}},[e._v("\n        您还没有创建项目，现在去\n        "),r("span",{staticClass:"creatspan",on:{click:function(n){e.dialogTableVisible=!0}}},[e._v("创建一个项目 ")]),e._v("吧！\n      ")])],1):r("ul",{attrs:{id:"projLists"}},e._l(e.ExistProjDatas,(function(n,a){return r("li",{key:a},[r("el-col",{attrs:{span:24}},[r("el-card",{staticClass:"projBox",attrs:{shadow:"hover"}},[r("div",{staticClass:"boxName",attrs:{slot:"header"},slot:"header"},[r("div",{staticStyle:{margin:"-18px -20px",padding:"10px 20px",height:"30px"}},[r("span",[e._v(e._s(n.name))]),r("el-button",e._b({staticStyle:{float:"right",margin:"0",padding:"0 0 0 5px","line-height":"30px"},attrs:{type:"text"},on:{click:function(t){return e.delectProject(n)}}},"el-button",{item:n},!1),[r("img",{attrs:{src:t("b32a")}})]),r("el-button",e._b({staticStyle:{float:"right",margin:"0",padding:"0 5px 0 5px","line-height":"30px"},attrs:{type:"text"},on:{click:function(t){return e.exportCSV(n)}}},"el-button",{item:n},!1),[r("img",{attrs:{src:t("7129")}})]),r("el-button",e._b({staticStyle:{float:"right",margin:"0",padding:"0 5px 0 0","line-height":"30px"},attrs:{type:"text"},on:{click:function(t){return e.viewDatas(n)}}},"el-button",{item:n},!1),[r("img",{attrs:{src:t("8008")}})])],1)]),r("div",{staticClass:"boxContent"},[r("div",{staticClass:"leftcon"},[r("div",[r("span",{staticClass:"hn"},[e._v("创建时间：")]),r("span",{staticClass:"cn"},[e._v(e._s(n.createtime.toLocaleString()))])]),r("div",[r("span",{staticClass:"hn"},[e._v("爬取城市：")]),r("span",{staticClass:"cn"},[e._v(e._s(n.province)+"-"+e._s(n.cityName))])]),r("div",[r("span",{staticClass:"hn"},[e._v("爬取类型：")]),r("span",{staticClass:"cn"},[e._v(e._s(n.keyWords))])])]),r("div",{staticClass:"rightcon"},[r("div",[r("span",{staticClass:"hn"},[e._v("爬取状态：")]),1!==n.progress?r("span",{staticClass:"cn"},[e._v("拼命爬取中")]):r("span",{staticClass:"cn"},[e._v("已完成")])]),r("div",[r("span",{staticClass:"hn"},[e._v("完成情况：")]),1!==n.progress?r("span",{staticClass:"cn"},[e._v(e._s((100*n.progress).toFixed(6))+"%")]):r("span",{staticClass:"cn"},[e._v(e._s(100*n.progress)+"%")])])])])]),1!==n.progress?r("progressbar",{attrs:{height:5,percentage:100*n.progress}}):e._e()],1)],1)})),0)],1)],1)},A=[],M=(t("cc57"),t("6d57"),t("b449"),t("17d6")),R=(t("7e13"),[{name:"北京市",code:"110000",children:[{name:"北京市市辖区",code:"110100",children:null}]},{name:"天津市",code:"120000",children:[{name:"天津市市辖区",code:"120100",children:null}]},{name:"河北省",code:"130000",children:[{name:"石家庄市",code:"130100",children:null},{name:"唐山市",code:"130200",children:null},{name:"秦皇岛市",code:"130300",children:null},{name:"邯郸市",code:"130400",children:null},{name:"邢台市",code:"130500",children:null},{name:"保定市",code:"130600",children:null},{name:"张家口市",code:"130700",children:null},{name:"承德市",code:"130800",children:null},{name:"沧州市",code:"130900",children:null},{name:"廊坊市",code:"131000",children:null},{name:"衡水市",code:"131100",children:null}]},{name:"山西省",code:"140000",children:[{name:"太原市",code:"140100",children:null},{name:"大同市",code:"140200",children:null},{name:"阳泉市",code:"140300",children:null},{name:"长治市",code:"140400",children:null},{name:"晋城市",code:"140500",children:null},{name:"朔州市",code:"140600",children:null},{name:"晋中市",code:"140700",children:null},{name:"运城市",code:"140800",children:null},{name:"忻州市",code:"140900",children:null},{name:"临汾市",code:"141000",children:null},{name:"吕梁市",code:"141100",children:null}]},{name:"内蒙古自治区",code:"150000",children:[{name:"呼和浩特市",code:"150100",children:null},{name:"包头市",code:"150200",children:null},{name:"乌海市",code:"150300",children:null},{name:"赤峰市",code:"150400",children:null},{name:"通辽市",code:"150500",children:null},{name:"鄂尔多斯市",code:"150600",children:null},{name:"呼伦贝尔市",code:"150700",children:null},{name:"巴彦淖尔市",code:"150800",children:null},{name:"乌兰察布市",code:"150900",children:null},{name:"兴安盟",code:"152200",children:null},{name:"锡林郭勒盟",code:"152500",children:null},{name:"阿拉善盟",code:"152900",children:null}]},{name:"辽宁省",code:"210000",children:[{name:"沈阳市",code:"210100",children:null},{name:"大连市",code:"210200",children:null},{name:"鞍山市",code:"210300",children:null},{name:"抚顺市",code:"210400",children:null},{name:"本溪市",code:"210500",children:null},{name:"丹东市",code:"210600",children:null},{name:"锦州市",code:"210700",children:null},{name:"营口市",code:"210800",children:null},{name:"阜新市",code:"210900",children:null},{name:"辽阳市",code:"211000",children:null},{name:"盘锦市",code:"211100",children:null},{name:"铁岭市",code:"211200",children:null},{name:"朝阳市",code:"211300",children:null},{name:"葫芦岛市",code:"211400",children:null}]},{name:"吉林省",code:"220000",children:[{name:"长春市",code:"220100",children:null},{name:"吉林市",code:"220200",children:null},{name:"四平市",code:"220300",children:null},{name:"辽源市",code:"220400",children:null},{name:"通化市",code:"220500",children:null},{name:"白山市",code:"220600",children:null},{name:"松原市",code:"220700",children:null},{name:"白城市",code:"220800",children:null},{name:"延边朝鲜族自治州",code:"222400",children:null}]},{name:"黑龙江省",code:"230000",children:[{name:"哈尔滨市",code:"230100",children:null},{name:"齐齐哈尔市",code:"230200",children:null},{name:"鸡西市",code:"230300",children:null},{name:"鹤岗市",code:"230400",children:null},{name:"双鸭山市",code:"230500",children:null},{name:"大庆市",code:"230600",children:null},{name:"伊春市",code:"230700",children:null},{name:"佳木斯市",code:"230800",children:null},{name:"七台河市",code:"230900",children:null},{name:"牡丹江市",code:"231000",children:null},{name:"黑河市",code:"231100",children:null},{name:"绥化市",code:"231200",children:null},{name:"大兴安岭地区",code:"232700",children:null}]},{name:"上海市",code:"310000",children:[{name:"上海市市辖区",code:"310100",children:null}]},{name:"江苏省",code:"320000",children:[{name:"南京市",code:"320100",children:null},{name:"无锡市",code:"320200",children:null},{name:"徐州市",code:"320300",children:null},{name:"常州市",code:"320400",children:null},{name:"苏州市",code:"320500",children:null},{name:"南通市",code:"320600",children:null},{name:"连云港市",code:"320700",children:null},{name:"淮安市",code:"320800",children:null},{name:"盐城市",code:"320900",children:null},{name:"扬州市",code:"321000",children:null},{name:"镇江市",code:"321100",children:null},{name:"泰州市",code:"321200",children:null},{name:"宿迁市",code:"321300",children:null}]},{name:"浙江省",code:"330000",children:[{name:"杭州市",code:"330100",children:null},{name:"宁波市",code:"330200",children:null},{name:"温州市",code:"330300",children:null},{name:"嘉兴市",code:"330400",children:null},{name:"湖州市",code:"330500",children:null},{name:"绍兴市",code:"330600",children:null},{name:"金华市",code:"330700",children:null},{name:"衢州市",code:"330800",children:null},{name:"舟山市",code:"330900",children:null},{name:"台州市",code:"331000",children:null},{name:"丽水市",code:"331100",children:null}]},{name:"安徽省",code:"340000",children:[{name:"合肥市",code:"340100",children:null},{name:"芜湖市",code:"340200",children:null},{name:"蚌埠市",code:"340300",children:null},{name:"淮南市",code:"340400",children:null},{name:"马鞍山市",code:"340500",children:null},{name:"淮北市",code:"340600",children:null},{name:"铜陵市",code:"340700",children:null},{name:"安庆市",code:"340800",children:null},{name:"黄山市",code:"341000",children:null},{name:"滁州市",code:"341100",children:null},{name:"阜阳市",code:"341200",children:null},{name:"宿州市",code:"341300",children:null},{name:"六安市",code:"341500",children:null},{name:"亳州市",code:"341600",children:null},{name:"池州市",code:"341700",children:null},{name:"宣城市",code:"341800",children:null}]},{name:"福建省",code:"350000",children:[{name:"福州市",code:"350100",children:null},{name:"厦门市",code:"350200",children:null},{name:"莆田市",code:"350300",children:null},{name:"三明市",code:"350400",children:null},{name:"泉州市",code:"350500",children:null},{name:"漳州市",code:"350600",children:null},{name:"南平市",code:"350700",children:null},{name:"龙岩市",code:"350800",children:null},{name:"宁德市",code:"350900",children:null}]},{name:"江西省",code:"360000",children:[{name:"南昌市",code:"360100",children:null},{name:"景德镇市",code:"360200",children:null},{name:"萍乡市",code:"360300",children:null},{name:"九江市",code:"360400",children:null},{name:"新余市",code:"360500",children:null},{name:"鹰潭市",code:"360600",children:null},{name:"赣州市",code:"360700",children:null},{name:"吉安市",code:"360800",children:null},{name:"宜春市",code:"360900",children:null},{name:"抚州市",code:"361000",children:null},{name:"上饶市",code:"361100",children:null}]},{name:"山东省",code:"370000",children:[{name:"济南市",code:"370100",children:null},{name:"青岛市",code:"370200",children:null},{name:"淄博市",code:"370300",children:null},{name:"枣庄市",code:"370400",children:null},{name:"东营市",code:"370500",children:null},{name:"烟台市",code:"370600",children:null},{name:"潍坊市",code:"370700",children:null},{name:"济宁市",code:"370800",children:null},{name:"泰安市",code:"370900",children:null},{name:"威海市",code:"371000",children:null},{name:"日照市",code:"371100",children:null},{name:"临沂市",code:"371300",children:null},{name:"德州市",code:"371400",children:null},{name:"聊城市",code:"371500",children:null},{name:"滨州市",code:"371600",children:null},{name:"菏泽市",code:"371700",children:null}]},{name:"河南省",code:"410000",children:[{name:"郑州市",code:"410100",children:null},{name:"开封市",code:"410200",children:null},{name:"洛阳市",code:"410300",children:null},{name:"平顶山市",code:"410400",children:null},{name:"安阳市",code:"410500",children:null},{name:"鹤壁市",code:"410600",children:null},{name:"新乡市",code:"410700",children:null},{name:"焦作市",code:"410800",children:null},{name:"濮阳市",code:"410900",children:null},{name:"许昌市",code:"411000",children:null},{name:"漯河市",code:"411100",children:null},{name:"三门峡市",code:"411200",children:null},{name:"南阳市",code:"411300",children:null},{name:"商丘市",code:"411400",children:null},{name:"信阳市",code:"411500",children:null},{name:"周口市",code:"411600",children:null},{name:"驻马店市",code:"411700",children:null}]},{name:"湖北省",code:"420000",children:[{name:"武汉市",code:"420100",children:null},{name:"黄石市",code:"420200",children:null},{name:"十堰市",code:"420300",children:null},{name:"宜昌市",code:"420500",children:null},{name:"襄阳市",code:"420600",children:null},{name:"鄂州市",code:"420700",children:null},{name:"荆门市",code:"420800",children:null},{name:"孝感市",code:"420900",children:null},{name:"荆州市",code:"421000",children:null},{name:"黄冈市",code:"421100",children:null},{name:"咸宁市",code:"421200",children:null},{name:"随州市",code:"421300",children:null},{name:"恩施土家族苗族自治州",code:"422800",children:null}]},{name:"湖南省",code:"430000",children:[{name:"长沙市",code:"430100",children:null},{name:"株洲市",code:"430200",children:null},{name:"湘潭市",code:"430300",children:null},{name:"衡阳市",code:"430400",children:null},{name:"邵阳市",code:"430500",children:null},{name:"岳阳市",code:"430600",children:null},{name:"常德市",code:"430700",children:null},{name:"张家界市",code:"430800",children:null},{name:"益阳市",code:"430900",children:null},{name:"郴州市",code:"431000",children:null},{name:"永州市",code:"431100",children:null},{name:"怀化市",code:"431200",children:null},{name:"娄底市",code:"431300",children:null},{name:"湘西土家族苗族自治州",code:"433100",children:null}]},{name:"广东省",code:"440000",children:[{name:"广州市",code:"440100",children:null},{name:"韶关市",code:"440200",children:null},{name:"深圳市",code:"440300",children:null},{name:"珠海市",code:"440400",children:null},{name:"汕头市",code:"440500",children:null},{name:"佛山市",code:"440600",children:null},{name:"江门市",code:"440700",children:null},{name:"湛江市",code:"440800",children:null},{name:"茂名市",code:"440900",children:null},{name:"肇庆市",code:"441200",children:null},{name:"惠州市",code:"441300",children:null},{name:"梅州市",code:"441400",children:null},{name:"汕尾市",code:"441500",children:null},{name:"河源市",code:"441600",children:null},{name:"阳江市",code:"441700",children:null},{name:"清远市",code:"441800",children:null},{name:"东莞市",code:"441900",children:null},{name:"中山市",code:"442000",children:null},{name:"潮州市",code:"445100",children:null},{name:"揭阳市",code:"445200",children:null},{name:"云浮市",code:"445300",children:null}]},{name:"广西壮族自治区",code:"450000",children:[{name:"南宁市",code:"450100",children:null},{name:"柳州市",code:"450200",children:null},{name:"桂林市",code:"450300",children:null},{name:"梧州市",code:"450400",children:null},{name:"北海市",code:"450500",children:null},{name:"防城港市",code:"450600",children:null},{name:"钦州市",code:"450700",children:null},{name:"贵港市",code:"450800",children:null},{name:"玉林市",code:"450900",children:null},{name:"百色市",code:"451000",children:null},{name:"贺州市",code:"451100",children:null},{name:"河池市",code:"451200",children:null},{name:"来宾市",code:"451300",children:null},{name:"崇左市",code:"451400",children:null}]},{name:"海南省",code:"460000",children:[{name:"海口市",code:"460100",children:null},{name:"三亚市",code:"460200",children:null},{name:"三沙市",code:"460300",children:null},{name:"儋州市",code:"460400",children:null}]},{name:"重庆市",code:"500000",children:[{name:"重庆市市辖区",code:"500100",children:null},{name:"重庆市郊县",code:"500200",children:null}]},{name:"四川省",code:"510000",children:[{name:"成都市",code:"510100",children:null},{name:"自贡市",code:"510300",children:null},{name:"攀枝花市",code:"510400",children:null},{name:"泸州市",code:"510500",children:null},{name:"德阳市",code:"510600",children:null},{name:"绵阳市",code:"510700",children:null},{name:"广元市",code:"510800",children:null},{name:"遂宁市",code:"510900",children:null},{name:"内江市",code:"511000",children:null},{name:"乐山市",code:"511100",children:null},{name:"南充市",code:"511300",children:null},{name:"眉山市",code:"511400",children:null},{name:"宜宾市",code:"511500",children:null},{name:"广安市",code:"511600",children:null},{name:"达州市",code:"511700",children:null},{name:"雅安市",code:"511800",children:null},{name:"巴中市",code:"511900",children:null},{name:"资阳市",code:"512000",children:null},{name:"阿坝藏族羌族自治州",code:"513200",children:null},{name:"甘孜藏族自治州",code:"513300",children:null},{name:"凉山彝族自治州",code:"513400",children:null}]},{name:"贵州省",code:"520000",children:[{name:"贵阳市",code:"520100",children:null},{name:"六盘水市",code:"520200",children:null},{name:"遵义市",code:"520300",children:null},{name:"安顺市",code:"520400",children:null},{name:"毕节市",code:"520500",children:null},{name:"铜仁市",code:"520600",children:null},{name:"黔西南布依族苗族自治州",code:"522300",children:null},{name:"黔东南苗族侗族自治州",code:"522600",children:null},{name:"黔南布依族苗族自治州",code:"522700",children:null}]},{name:"云南省",code:"530000",children:[{name:"昆明市",code:"530100",children:null},{name:"曲靖市",code:"530300",children:null},{name:"玉溪市",code:"530400",children:null},{name:"保山市",code:"530500",children:null},{name:"昭通市",code:"530600",children:null},{name:"丽江市",code:"530700",children:null},{name:"普洱市",code:"530800",children:null},{name:"临沧市",code:"530900",children:null},{name:"楚雄彝族自治州",code:"532300",children:null},{name:"红河哈尼族彝族自治州",code:"532500",children:null},{name:"文山壮族苗族自治州",code:"532600",children:null},{name:"西双版纳傣族自治州",code:"532800",children:null},{name:"大理白族自治州",code:"532900",children:null},{name:"德宏傣族景颇族自治州",code:"533100",children:null},{name:"怒江傈僳族自治州",code:"533300",children:null},{name:"迪庆藏族自治州",code:"533400",children:null}]},{name:"西藏自治区",code:"540000",children:[{name:"拉萨市",code:"540100",children:null},{name:"日喀则市",code:"540200",children:null},{name:"昌都市",code:"540300",children:null},{name:"林芝市",code:"540400",children:null},{name:"山南市",code:"540500",children:null},{name:"那曲市",code:"540600",children:null},{name:"阿里地区",code:"542500",children:null}]},{name:"陕西省",code:"610000",children:[{name:"西安市",code:"610100",children:null},{name:"铜川市",code:"610200",children:null},{name:"宝鸡市",code:"610300",children:null},{name:"咸阳市",code:"610400",children:null},{name:"渭南市",code:"610500",children:null},{name:"延安市",code:"610600",children:null},{name:"汉中市",code:"610700",children:null},{name:"榆林市",code:"610800",children:null},{name:"安康市",code:"610900",children:null},{name:"商洛市",code:"611000",children:null}]},{name:"甘肃省",code:"620000",children:[{name:"兰州市",code:"620100",children:null},{name:"嘉峪关市",code:"620200",children:null},{name:"金昌市",code:"620300",children:null},{name:"白银市",code:"620400",children:null},{name:"天水市",code:"620500",children:null},{name:"武威市",code:"620600",children:null},{name:"张掖市",code:"620700",children:null},{name:"平凉市",code:"620800",children:null},{name:"酒泉市",code:"620900",children:null},{name:"庆阳市",code:"621000",children:null},{name:"定西市",code:"621100",children:null},{name:"陇南市",code:"621200",children:null},{name:"临夏回族自治州",code:"622900",children:null},{name:"甘南藏族自治州",code:"623000",children:null}]},{name:"青海省",code:"630000",children:[{name:"西宁市",code:"630100",children:null},{name:"海东市",code:"630200",children:null},{name:"海北藏族自治州",code:"632200",children:null},{name:"黄南藏族自治州",code:"632300",children:null},{name:"海南藏族自治州",code:"632500",children:null},{name:"果洛藏族自治州",code:"632600",children:null},{name:"玉树藏族自治州",code:"632700",children:null},{name:"海西蒙古族藏族自治州",code:"632800",children:null}]},{name:"宁夏回族自治区",code:"640000",children:[{name:"银川市",code:"640100",children:null},{name:"石嘴山市",code:"640200",children:null},{name:"吴忠市",code:"640300",children:null},{name:"固原市",code:"640400",children:null},{name:"中卫市",code:"640500",children:null}]},{name:"新疆维吾尔自治区",code:"650000",children:[{name:"乌鲁木齐市",code:"650100",children:null},{name:"克拉玛依市",code:"650200",children:null},{name:"吐鲁番市",code:"650400",children:null},{name:"哈密市",code:"650500",children:null},{name:"昌吉回族自治州",code:"652300",children:null},{name:"博尔塔拉蒙古自治州",code:"652700",children:null},{name:"巴音郭楞蒙古自治州",code:"652800",children:null},{name:"阿克苏地区",code:"652900",children:null},{name:"克孜勒苏柯尔克孜自治州",code:"653000",children:null},{name:"喀什地区",code:"653100",children:null},{name:"和田地区",code:"653200",children:null},{name:"伊犁哈萨克自治州",code:"654000",children:null},{name:"塔城地区",code:"654200",children:null},{name:"阿勒泰地区",code:"654300",children:null}]},{name:"台湾省",code:"710000",children:[{name:"台湾省",code:"710000",children:null}]},{name:"香港特别行政区",code:"810000",children:[{name:"香港特别行政区",code:"810000",children:null}]},{name:"澳门特别行政区",code:"820000",children:[{name:"澳门特别行政区",code:"820000",children:null}]}]),j={pcs:R},D=t("aef5");t("70da"),t("f548"),t("9dd9"),t("2b45");t("391c");var I={name:"Xingqudian",_crawler:null,data:function(){return{dialogTableVisible:!1,creProj:{projname:"",spidertype:"",scriptResource:"https://webapi.amap.com/maps?v=1.4.15&key=0971acd2037ad6fda6f8020298651877&plugin=AMap.PlaceSearch",searchFunc:'function search(bounds, keywords, cityname, pageindex, pagesize){let option = {city: cityname, type: keywords,pageSize: pagesize,pageIndex: pageindex,};let searcher = new AMap.PlaceSearch(option);let bs = new AMap.Bounds(new AMap.LngLat(bounds[0], bounds[1]), new AMap.LngLat(bounds[2], bounds[3]));searcher.searchInBounds(keywords, bs,(str, res) => {if (str === "no_data") {this.continueWorking(false, this.parseIsLastIdx(res), null);} else if (str === "error") {this.continueWorking(true);} else {let pois = this.parsePOIArr(res);let isLastIdx = this.parseIsLastIdx(res);this.continueWorking(false, isLastIdx, pois);}});}',provinceObj:{},cityObj:{},cityGeoJson:{}},spiderTypes:[],districtSearch:void 0,provinces:[],cities:[],rulesCreProj:{projname:[{required:!0,message:"请输入项目名",trigger:"blur"}],spidertype:[{required:!0,message:"请输入抓取类型",trigger:"blur"}]},ExistProjDatas:[]}},computed:{noProj:function(){return 0===this.ExistProjDatas.length},itemsNum:function(){return this.ExistProjDatas.length}},watch:{ExistProjDatas:function(){this.debouncedExistProjDatas()}},created:function(){this.initExistProjDatas(),this.debouncedExistProjDatas=_.debounce(this.initExistProjDatas,2e3)},mounted:function(){this.initCity(),this.initType()},methods:{goBack:function(){this.$router.push({name:"catalog"})},initExistProjDatas:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(){var n,t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new D["a"].Crawler,e.next=3,n.init();case 3:n.getManyPoiTaskInfo(1,10).then((function(e){t.ExistProjDatas=e.data}));case 4:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),addDialogClose:function(){this.$refs.addFormRef.resetFields()},initCity:function(){var e=this;console.log(j),console.log(j.length),this.provinces=[],this.cities=[],j.pcs.forEach((function(n){e.provinces.push(n)}))},getData:function(e,n){"province"===n&&(this.cities=[]);var t=e.districtList;if(t){var r=t[0].level;("province"===r||"city"===r)&&this.traverseSubList(t,r)}},traverseSubList:function(e,n){var t=this;e.forEach((function(e){var r={};r.adcode=e.adcode,r.name=e.name,r.level=e.level,"province"===n?t.provinces.push(r):"city"===n&&t.cities.push(r)}))},cityChanged:function(e){var n=this,t=this.creProj.cityObj.code,r="".concat(t),a="geojsons/".concat(r,".json");this.$axios.get(a).then((function(e){n.creProj.cityGeoJson=e.data,console.log(e.data)}))},search:function(e){var n=this.creProj.provinceObj.children;this.cities=[];for(var t=0;t<n.length;t++)this.cities.push(n[t])},initType:function(){var e=this;e.spiderTypes=[];for(var n=D["a"].Crawler.GetPoiTypes(),t=0;t<n.length;t++){var r={label:n[t],value:n[t]};e.spiderTypes.push(r)}},createProject:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(n,t,r,a,l){var i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=new D["a"].Crawler,e.next=3,i.init();case 3:return c={name:n,geojson:t,width:400,keywords:r,resources:a,searchFncStr:l},e.next=6,i.crateCrawlTask(c);case 6:this.initExistProjDatas(),this.$message.success("创建成功");case 8:case"end":return e.stop()}}),e,this)})));function n(n,t,r,a,l){return e.apply(this,arguments)}return n}(),onCreProj:function(){var e=this;this.$refs.addFormRef.validate(function(){var n=Object(M["a"])(regeneratorRuntime.mark((function n(t){var r,a,l,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",null);case 2:e.dialogTableVisible=!1,r=e.creProj.projname,a=e.creProj.spidertype,l=e.creProj.cityGeoJson,i=[e.creProj.scriptResource],c=e.creProj.searchFunc,e.createProject(r,l,a,i,c);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},delectProject:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(n){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.id,console.log(t),r=new D["a"].Crawler,e.next=5,r.init();case 5:return e.next=7,r.tryDeleteTask(t);case 7:a=e.sent,console.log(a),a?this.$message.success("删除成功"):this.$message.success("删除失败");case 10:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}(),submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(e,n){console.log(e,n)},handlePreview:function(e){console.log(e)},beforeupload:function(e){var n=this;return e.text().then((function(e){n.creProj.cityGeoJson=JSON.parse(e)})),!1},exportCSV:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(n){var t,r,a,l,i,c,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.id,r="".concat(n.name,"-").concat(n.keyWords,".csv"),a=new D["a"].Crawler,e.next=5,a.init();case 5:return l="data:text/csv;charset=utf-8,\ufeff",window.navigator.msSaveOrOpenBlob&&(l="\ufeff"),e.next=9,a.export2csv(t);case 9:i=e.sent,l+=i,window.navigator.msSaveOrOpenBlob?(c=new Blob([decodeURIComponent(encodeURI(l))],{type:"text/csv;charset=utf-8;"}),navigator.msSaveBlob(c,r)):(o=encodeURI(l),s=document.createElement("a"),s.setAttribute("href",o),s.setAttribute("download",r),document.body.appendChild(s),s.click());case 12:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}(),viewDatas:function(e){console.log(e);var n=e.geoJson,t=n.features[0].properties.center,r=[t.lng,t.lat],a=this.$router.resolve({name:"viewdatas",query:{id:e.id,center:r}});window.open(a.href,"_blank")}}},L=I,T=(t("aba0"),Object(u["a"])(L,O,A,!1,null,null,null)),S=T.exports,B=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"all"},[t("div",{ref:"rootmap",attrs:{id:"mymap"}}),t("el-radio-group",{staticClass:"styleSelect",attrs:{size:"mini"},on:{change:e.changeMapstyle},model:{value:e.mapStyle,callback:function(n){e.mapStyle=n},expression:"mapStyle"}},e._l(e.mapStyles,(function(n){return t("el-radio-button",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label))])})),1),t("div",{staticClass:"colorpickerGroup"},[t("el-col",{attrs:{span:12}},[t("span",[e._v("边界颜色：")]),t("el-color-picker",{attrs:{"show-alpha":"",size:"small"},on:{"active-change":e.changeBordercolor},model:{value:e.boderColor,callback:function(n){e.boderColor=n},expression:"boderColor"}})],1),t("el-col",{attrs:{span:12}},[t("span",[e._v("POI颜色：")]),t("el-color-picker",{attrs:{"show-alpha":"",size:"small"},on:{"active-change":e.changePointcolor},model:{value:e.pointColor,callback:function(n){e.pointColor=n},expression:"pointColor"}})],1),t("el-col",{attrs:{span:12}},[t("span",[e._v("边界半径："+e._s(this.borderRadius))]),t("el-slider",{staticStyle:{width:"120px"},attrs:{max:"20"},on:{change:e.changeBorderRadius},model:{value:e.borderRadius,callback:function(n){e.borderRadius=n},expression:"borderRadius"}})],1),t("el-col",{attrs:{span:12}},[t("span",[e._v("POI半径："+e._s(this.pointRadius))]),t("el-slider",{staticStyle:{width:"120px"},attrs:{max:"20"},on:{change:e.changePointRadius},model:{value:e.pointRadius,callback:function(n){e.pointRadius=n},expression:"pointRadius"}})],1)],1)],1)},W=[],U=(t("4f21"),t("5fa1")),K=t("ff3a"),N=t("748f"),G=t("75d4"),F=t("c473"),q=t("f654"),z=t("9c18"),V=t("62ea"),Y=t("614d"),J=t("834b"),Q=t("18de"),Z={data:function(){return{mapboxKey:"pk.eyJ1Ijoiemhhbmdhc3luY2p1biIsImEiOiJjam9tYncyaXkwbWd4M29tdGRsMXczOGUzIn0.2Q1IDIWtQTSOTUn_S3iQ1A",dataId:this.$route.query.id,boundRes:void 0,bound_geojson:void 0,bound_center:void 0,poi_geojson:void 0,map:void 0,mapStyle:"light-v9",mapStyles:[{label:"light",value:"light-v9"},{label:"dark",value:"dark-v10"},{label:"streets",value:"streets-v11"},{label:"outdoors",value:"outdoors-v11"},{label:"satellite",value:"satellite-v9"}],basicLayer:void 0,boderColor:"#f6e7cc",borderRadius:2,pointColor:"#8076a3",pointRadius:1,bound_Layer:void 0,poi_Layer:void 0}},mounted:function(){this.initMap()},methods:{initMap:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(){var n,t,r,a,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.basicLayer=new G["a"]({source:new q["a"]({url:"https://api.mapbox.com/styles/v1/mapbox/"+this.mapStyle+"/tiles/256/{z}/{x}/{y}?access_token="+this.mapboxKey}),zindex:0}),this.map=new U["a"]({target:this.$refs.rootmap,layers:[this.basicLayer],view:new K["a"]({projection:"EPSG:4326",center:this.$route.query.center,zoom:10})}),n=new V["a"]({radius:1,fill:new Y["a"]({color:"#8076a3"}),stroke:new J["a"]({color:"#8076a3",width:1})}),t={Point:new Q["b"]({image:n}),Polygon:new Q["b"]({stroke:new J["a"]({color:"#f6e7cc",width:2}),fill:null})},r=new D["a"].Crawler,e.next=7,r.init();case 7:return e.next=9,r.getGeoJson(this.dataId);case 9:return a=e.sent,e.next=12,r.getPoiTaskInfo(this.dataId);case 12:l=e.sent,l=l.data.geoJson,this.bound_Layer=new F["a"]({source:new z["a"]({features:(new N["a"]).readFeatures(l)}),style:t.Polygon,zIndex:1}),this.poi_Layer=new F["a"]({source:new z["a"]({features:(new N["a"]).readFeatures(a)}),style:t.Point,zIndex:2}),this.map.addLayer(this.bound_Layer),this.map.addLayer(this.poi_Layer);case 18:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}(),changeMapstyle:function(e){console.log(e);var n=new G["a"]({source:new q["a"]({url:"https://api.mapbox.com/styles/v1/mapbox/"+e+"/tiles/256/{z}/{x}/{y}?access_token="+this.mapboxKey}),zIndex:0});this.map.removeLayer(this.basicLayer),this.map.addLayer(n),this.basicLayer=n},changeBordercolor:function(e){var n=new Q["b"]({stroke:new J["a"]({color:e,width:this.borderRadius}),fill:null});this.bound_Layer.setStyle(n)},changePointcolor:function(e){var n=new V["a"]({radius:this.pointRadius,fill:new Y["a"]({color:e}),stroke:new J["a"]({color:e,width:1})}),t=new Q["b"]({image:n});this.poi_Layer.setStyle(t)},chnageBorderRadius:function(e){var n=new Q["b"]({stroke:new J["a"]({color:this.boderColor,width:e}),fill:null});this.bound_Layer.setStyle(n)},changePointRadius:function(e){var n=new V["a"]({radius:e,fill:new Y["a"]({color:this.pointColor}),stroke:new J["a"]({color:this.pointColor,width:1})}),t=new Q["b"]({image:n});this.poi_Layer.setStyle(t)}}},H=Z,X=(t("48ac"),Object(u["a"])(H,B,W,!1,null,"71436c92",null)),$=X.exports,ee=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"all"},[t("div",{ref:"rootmap",attrs:{id:"myMap"}}),t("el-radio-group",{staticClass:"styleSelect",attrs:{size:"mini"},on:{change:e.changeMapstyle},model:{value:e.mapStyle,callback:function(n){e.mapStyle=n},expression:"mapStyle"}},e._l(e.mapStyles,(function(n){return t("el-radio-button",{key:n.value,attrs:{label:n.value}},[e._v(e._s(n.label))])})),1),t("div",{staticClass:"layerMenu"},[t("div",{staticClass:"menu-top"},[t("div",{staticClass:"layerInfo"},[t("div",{staticClass:"layerInfo-text"},[e._v("当前城市："+e._s(e.cityName))])]),t("div",{staticClass:"pull-icon",class:{"pull-up":e.isActive},on:{click:e.changeIcon}})]),e.isActive?t("ul",{staticClass:"menu-content"},e._l(e.citylist,(function(n,r){return t("li",{key:n.city,staticClass:"city-item",attrs:{label:n.name}},[t("div",{staticClass:"city-item-content"},[t("div",{staticClass:"city-item-name"},[e._v("\n                            "+e._s(n.name)+"\n                        ")]),t("div",{staticClass:"city-item-dl",on:{click:function(n){return e.downloadJSON(r)}}},[e._v("\n                            下载\n                        ")]),t("div",{staticClass:"city-item-see",on:{click:function(n){return e.seeData(r)}}},[e._v("\n                            查看\n                        ")])])])})),0):e._e()])],1)},ne=[],te=t("f2a7"),re=(t("c0c3"),t("4324")),ae=t("1b6a"),le=t("b081"),ie=t("a886"),ce=t.n(ie),oe=function(){function e(){Object(re["a"])(this,e),Object(le["a"])(this,"citylist",null),Object(le["a"])(this,"subway",null),this.beijing_sub_way=null,this.subway=null,this.citylist=null;var n=this;window.cbk=function(){n.subway=window.subway,n.initCityList()};var t=["https://webapi.amap.com/subway?v=1.0&key=0971acd2037ad6fda6f8020298651877&callback=cbk","https://webapi.amap.com/maps?v=1.4.15&key=0971acd2037ad6fda6f8020298651877&plugin=AMap.LineSearch"];this.loadScripts(t,(function(){console.log("done")}))}return Object(ae["a"])(e,[{key:"initCityList",value:function(){var e=this,n=document.createElement("div");n.style.visibility="hidden",n.id="hidden_beijing_subway",document.body.appendChild(n);var t=this.subway("hidden_beijing_subway",{adcode:1100,theme:"colorful",client:0,doubleclick:{switch:!0}});t.event.on("subway.complete",(function(n,r){t.getCityList((function(n){e.citylist=n}))}))}},{key:"getCityList",value:function(e){var n=this;this.citylist?e(this.citylist):setTimeout((function(){n.getCityList(e)}),10)}},{key:"getGeoJson",value:function(e,n){var t=this;this.subway?this.getCityLines(e,(function(r){for(var a={type:"FeatureCollection",features:[]},l={type:"FeatureCollection",features:[]},i=0,c=0;c<r.length;c++){var o=r[c],s=o.shortname,u=(o.id,new AMap.LineSearch({pageIndex:1,city:e,pageSize:5,extensions:"all"}));u.search(s,(function(c,o){if("complete"===c&&"OK"===o.info){for(var s=0;s<o.lineInfo.length;s++){var u=o.lineInfo[s],d=u.type;if("地铁"===d)if(l.features.length>0){for(var _=u.id,h=!1,m=!1,p=u.start_stop,f=u.end_stop,v=0;v<l.features.length;v++){var b=l.features[v].properties.id;b===_&&(h=!0);var g=l.features[v].properties.start_stop,y=l.features[v].properties.end_stop;g!==f&&y!==p||(m=!0)}if(h||m)continue;var w=t.parse_to_point_feature(o.lineInfo[s]),k=t.parse_to_line_feature(o.lineInfo[s]);a.features=a.features.concat(w),l.features.push(k)}else{var E=t.parse_to_point_feature(o.lineInfo[s]),x=t.parse_to_line_feature(o.lineInfo[s]);a.features=a.features.concat(E),l.features.push(x)}}i++,i===r.length&&n({cityCode:e,point_geo_json:a,line_geojson:l})}}))}})):setTimeout((function(){t.getGeoJson(e,n)}),10)}},{key:"parse_to_point_feature",value:function(e){for(var n=[],t=0;t<e.via_stops.length;t++){var r=e.via_stops[t],a={type:"Feature",properties:{id:r.id,line_id:e.id,line_name:e.name,citycode:e.citycode,name:r.name,sequence:r.sequence},geometry:{type:"Point",coordinates:ce.a.gcj02towgs84(r.location.lng,r.location.lat)}};n.push(a)}return n}},{key:"parse_to_line_feature",value:function(e){for(var n=[],t=0;t<e.path.length;t++){var r=e.path[t],a=r.lng,l=r.lat,i=ce.a.gcj02towgs84(a,l);n.push(i)}var c={type:"Feature",properties:{id:e.id,type:e.type,name:e.name,citycode:e.citycode,start_stop:e.start_stop,end_stop:e.end_stop,stime:e.stime,etime:e.etime,uicolor:e.uicolor,timedesc:e.timedesc,loop:e.loop,status:e.status,direc:e.direc,company:e.company,distance:e.distance,basic_price:e.basic_price,total_price:e.total_price},geometry:{type:"LineString",coordinates:n}};return c}},{key:"getCityLines",value:function(e,n){var t="city"+e,r=document.getElementById(t);r&&r.parentNode.removeChild(r),r=document.createElement("div"),r.style.visibility="hidden",r.id=t,document.body.appendChild(r);var a=this.subway(t,{adcode:e,theme:"colorful",client:0,doubleclick:{switch:!0}});a.event.on("subway.complete",(function(e,t){a.getLineList((function(e){return n(e)}))}))}},{key:"loadScripts",value:function(e,n){var t=function(e,n){var t=document.createElement("script");t.src=e,t.onload=t.onreadystatechange=function(){t.onreadystatechange=t.onload=null,n()};var r=document.getElementsByTagName("head")[0];(r||document.body).appendChild(t)};(function r(){0!=e.length?t(e.shift(),r):n&&n()})()}}]),e}(),se={SubwayCrawler:oe},ue={data:function(){return{mapboxKey:"pk.eyJ1Ijoiemhhbmdhc3luY2p1biIsImEiOiJjam9tYncyaXkwbWd4M29tdGRsMXczOGUzIn0.2Q1IDIWtQTSOTUn_S3iQ1A",citylist:null,map:void 0,mapStyle:"light-v9",mapStyles:[{label:"light",value:"light-v9"},{label:"dark",value:"dark-v10"},{label:"streets",value:"streets-v11"},{label:"outdoors",value:"outdoors-v11"},{label:"satellite",value:"satellite-v9"}],basicLayer:void 0,isActive:!1,cityName:"北京"}},created:function(){this.getCityData()},mounted:function(){this.initMap()},methods:{getCityData:function(){var e=this,n=new se.SubwayCrawler;n.getCityList((function(n){return e.citylist=n}))},initMap:function(){this.basicLayer=new G["a"]({source:new q["a"]({url:"https://api.mapbox.com/styles/v1/mapbox/"+this.mapStyle+"/tiles/256/{z}/{x}/{y}?access_token="+this.mapboxKey}),zindex:0}),this.map=new U["a"]({target:this.$refs.rootmap,layers:[this.basicLayer],view:new K["a"]({projection:"EPSG:4326",center:[116.403694,39.91405],zoom:10})})},changeMapstyle:function(e){var n=new G["a"]({source:new q["a"]({url:"https://api.mapbox.com/styles/v1/mapbox/"+e+"/tiles/256/{z}/{x}/{y}?access_token="+this.mapboxKey}),zIndex:0});this.map.removeLayer(this.basicLayer),this.map.addLayer(n),this.basicLayer=n},changeIcon:function(){this.isActive=!this.isActive},seeData:function(e){var n=new se.SubwayCrawler,t=this;n.getGeoJson(e,(function(e){var n=e.line_geojson,r=e.point_geo_json,a=Object(te["a"])(e.point_geo_json),l=a.geometry.coordinates,i=new V["a"]({radius:2.5,fill:new Y["a"]({color:"#8076a3"})}),c=new Q["b"]({image:i}),o=new F["a"]({source:new z["a"]({features:(new N["a"]).readFeatures(n)}),style:function(e,n){var t=[],r="#".concat(e.get("uicolor")),a=new Q["b"]({stroke:new J["a"]({color:r,width:4})});return t.push(a),t},zIndex:1}),s=new F["a"]({source:new z["a"]({features:(new N["a"]).readFeatures(r)}),style:c,zIndex:2});t.map.getView().animate({center:l}),t.map.addLayer(o),t.map.addLayer(s)}))},downloadJSON:function(e){var n=new se.SubwayCrawler;n.getGeoJson(e,(function(n){var t=document.createElement("a");t.download="".concat(e,".json"),t.style.display="none";var r=new Blob([JSON.stringify(n)]);t.href=URL.createObjectURL(r),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))}}},de=ue,_e=(t("7685"),Object(u["a"])(de,ee,ne,!1,null,"276f2783",null)),he=_e.exports;r["default"].use(y["a"]);var me=new y["a"]({routes:[{path:"/",name:"catalog",component:P},{path:"/xingqd",name:"xingqd",component:S},{path:"/viewdatas/",name:"viewdatas",component:$},{path:"/subway",name:"subway",component:he}],mode:"hash"}),pe=t("82ae"),fe=t.n(pe),ve=function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",[r("el-container",{staticClass:"header"},[r("div",{staticClass:"header-container"},[r("div",{staticClass:"header-title"},[r("div",{staticClass:"header-title-container"},[r("span",{staticClass:"title-sign"},[e._v("Map Note")]),r("span",{staticClass:"title-one",attrs:{id:"one-data"}},[e._v("数据")]),r("span",{staticClass:"title-one",attrs:{id:"one-tool"}},[e._v("抓取工具")])])]),r("div",{staticClass:"userName"},[r("img",{attrs:{src:t("b138")}}),r("span",{staticClass:"nameFont"},[e._v("Yet")])])])])],1)},be=[],ge={name:"HeaderBox",components:{},mounted:function(){this.hehehe()},methods:{hehehe:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new D["a"].Crawler,e.next=3,n.init();case 3:n.pubsub();case 4:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()}},ye=ge,we=(t("042c"),Object(u["a"])(ye,ve,be,!1,null,"4ad57dce",null)),ke=we.exports,Ee=function(e){e.component("Headerbox",ke)},xe=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"vue-progress-bar__outer"},[t("div",{staticClass:"vue-progress-bar__inner",style:e.barStyle})])},Ce=[],Pe=(t("163d"),{props:{height:{type:Number,default:0,required:!0,validator:function(e){return e>=0}},percentage:{type:Number,default:0,required:!0,validator:function(e){return e>=0&&e<=100}}},computed:{barStyle:function(){var e={};return e.width=this.percentage+"%",e.height=this.height+"px",e}}}),Oe=Pe,Ae=(t("2ade"),Object(u["a"])(Oe,xe,Ce,!1,null,"4f4521a3",null)),Me=Ae.exports;r["default"].config.productionTip=!1,r["default"].prototype.$axios=fe.a,fe.a.defaults.headers.common["Access-Control-Allow-Origin"]="*",fe.a.defaults.headers["Content-Type"]="application/json",r["default"].component("progressbar",Me),r["default"].use(Ee),new r["default"]({router:me,render:function(e){return e(v)}}).$mount("#app")},"6fe1":function(e,n,t){e.exports=t.p+"img/POI.0fa1335a.png"},7129:function(e,n){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAB+klEQVRIib3WQW7aQBSAYR+BI/gIHIEDdMERWPQAPgI34AhZdT2ypdiuigpdWG1pxcgGlZTICaFNmsglEBCogUR/N4PrAMYB2o70JNuaed/4afRsTUsMIA8cAUN2HwLIa2kDyAFSTR6q611iuW4zAhhq0hGQS91J+gaNrQhQUROKuyZ/FpIACvsCW5G/Bawi/wRQ+WoA/x8Yj6cvHCELtpCGawUV1woqjpClYyHTz/guwOcPZ6eu6eOaPlW7zenJNb0w4t2bDvXXnVdAWc3VgSKgq/WF5AlcA37ejN8DNLyQJTCIJnRal3j1Lg0vpNXsc3EW/fr65eqlSl4CjMQGNwO2kMVeGJEEqnab8WgWY67p49W7zKb3tOS3qUqSA2rqWm4skRAy55r+cBOwmD88AZbRaV0SXd9dJBIVgMpGwBbScE2fVcA1fcajGa1mn6rdjkvU8ML47RwhdVUmudoBYsC1ApEGVO02vTDi5scdzY/nePVufO/VuzhCFlSZBCv96w9g+udpQFY4QpYzj+khgGsFlWzACmr7AraQqZ03BhwhyweUSH8OoO8FWEEtLfkTQNM0zRbS2BEYZvWmtVZx0r7qAHzv32Ymd4QsZSTXUd/15MPcYvE4AJhN7xlEk7UY3c4mi/nDJ7W7bbH8KzFW5fx8vnjL4UMuk/8G/9T6DKjCa9MAAAAASUVORK5CYII="},7685:function(e,n,t){"use strict";var r=t("cc16"),a=t.n(r);a.a},"7f92":function(e,n,t){},8008:function(e,n){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABNUlEQVRIie2VXZWEMAyFRwISkIAEJCChEpBQByMBCZVQCSOhEkbCtw9NIGTL2WWGM2cf9j5B0tybHxput78AYAQS8ACKPIcriDtg4RgZ6N4RSEL0BGZgAHogiA0gv0o+GfL+oLoiZ8JZ8k7KB5iNfQRG8x7kTJKYEYgyq8WTDsap5aPZm4rWjIVUYWMAsOTJ+ezhzmSvmBoCSHKxJaBYhMi2aHJzCUZUqyrA4Pm+CbiWzRr8izlF5/tZQOxFXNnZ7f0ouLtwRmDtp4oIuZ3ZvRH3kgDUIfoPIjbiTgssQq4opkWXCERpzYM62N76LhE46fsXeFNABhrYLpruGLsOdgLst2lbgPY29XgCd7b7kKifrI/JLQFLkqn7qKcutRaJx1opdn2Y4CRlHv5n2dqQTSK79n0UX4Y1Si+y8G0SAAAAAElFTkSuQmCC"},aba0:function(e,n,t){"use strict";var r=t("e37a"),a=t.n(r);a.a},aef5:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("c0c3"),core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_regexp_search__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("cc57"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_1__),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("b449"),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_2__),E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("17d6"),E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("4324"),E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("1b6a"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("2b45"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("f548"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_7__),dexie__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("7e13"),coordtransform__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("a886"),coordtransform__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(coordtransform__WEBPACK_IMPORTED_MODULE_9__),_turf_turf__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("5e1a"),_turf_turf__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(_turf_turf__WEBPACK_IMPORTED_MODULE_10__);function NewGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0,t="x"==e?n:3&n|8;return t.toString(16)}))}var testJson={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[114.86029,36.49085],[114.85837,36.4688],[114.85329,36.44128],[114.8548,36.43258],[114.8636,36.42966],[114.88063,36.42656],[114.88492,36.42246],[114.88724,36.41721],[114.88645,36.41147],[114.88167,36.40778],[114.87378,36.40475],[114.86475,36.40218],[114.84159,36.39952],[114.83229,36.39535],[114.82798,36.38873],[114.83018,36.38851],[114.83025,36.38359],[114.83272,36.3826],[114.83017,36.38208],[114.83122,36.37891],[114.8304,36.37331],[114.82633,36.37301],[114.82451,36.36615],[114.82319,36.3659],[114.82204,36.36047],[114.82596,36.35969],[114.82514,36.35586],[114.82283,36.35472],[114.82379,36.35416],[114.81955,36.34763],[114.80141,36.32759],[114.79139,36.31378],[114.78495,36.30824],[114.76585,36.2971],[114.75372,36.29425],[114.75161,36.30093],[114.75447,36.3006],[114.75537,36.30349],[114.76127,36.3023],[114.76423,36.3185],[114.75661,36.31865],[114.75716,36.32313],[114.75615,36.32437],[114.74814,36.32449],[114.74726,36.32269],[114.74447,36.32278],[114.74202,36.32423],[114.73374,36.32514],[114.73307,36.32648],[114.72974,36.3273],[114.72235,36.32793],[114.72439,36.34477],[114.71944,36.3457],[114.71919,36.34772],[114.71376,36.34868],[114.71382,36.35155],[114.70792,36.35215],[114.70755,36.34801],[114.70423,36.34792],[114.70436,36.35326],[114.70262,36.3534],[114.70278,36.35636],[114.69446,36.3577],[114.6945,36.36283],[114.68481,36.36137],[114.68519,36.36476],[114.66765,36.36586],[114.66682,36.36399],[114.65807,36.3644],[114.65714,36.35825],[114.64992,36.35755],[114.64921,36.35223],[114.63642,36.35361],[114.63662,36.35644],[114.62576,36.35772],[114.62623,36.36497],[114.61736,36.36574],[114.61681,36.36237],[114.60073,36.36233],[114.59992,36.35618],[114.58828,36.35609],[114.58206,36.36532],[114.58164,36.37448],[114.58325,36.38091],[114.58088,36.38799],[114.55786,36.39512],[114.54459,36.39437],[114.54414,36.4043],[114.52212,36.40466],[114.52098,36.39221],[114.52228,36.39174],[114.52178,36.38935],[114.51174,36.3898],[114.5072,36.38735],[114.50948,36.4035],[114.50634,36.40384],[114.50646,36.40673],[114.50483,36.40769],[114.49512,36.40643],[114.49512,36.40813],[114.49097,36.40785],[114.4876,36.40913],[114.48942,36.41969],[114.49404,36.42717],[114.49629,36.43435],[114.49783,36.43447],[114.50189,36.44014],[114.50564,36.45284],[114.5124,36.46715],[114.51624,36.47171],[114.51267,36.49445],[114.51359,36.49678],[114.51575,36.49698],[114.51595,36.49801],[114.52311,36.49808],[114.52766,36.49555],[114.53683,36.49727],[114.54253,36.49647],[114.55668,36.48259],[114.58838,36.48428],[114.59892,36.48141],[114.60893,36.47625],[114.62286,36.47526],[114.63498,36.48113],[114.63519,36.4864],[114.65777,36.48315],[114.66213,36.48831],[114.6706,36.48958],[114.67742,36.49367],[114.68292,36.49325],[114.68384,36.49608],[114.68871,36.49319],[114.69884,36.49269],[114.70336,36.49412],[114.70877,36.49191],[114.71992,36.49221],[114.72345,36.49453],[114.72501,36.50624],[114.72848,36.5067],[114.7408,36.5057],[114.74085,36.501],[114.74665,36.50007],[114.75278,36.50561],[114.76393,36.50518],[114.76855,36.50274],[114.76945,36.49843],[114.77562,36.49691],[114.84839,36.50058],[114.85579,36.49907],[114.86029,36.49085]]]},properties:{name:"成安县",adcode:"130424",telecode:"0310",level:"district",parent:{name:"邯郸市",level:"city",adcode:"130400",center:{crs:{type:"name",properties:{name:"urn:ogc:def:crs:EPSG:6.3:4326"}},type:"Point",coordinates:[114.490686,36.612273]}},center:{lng:114.680356,lat:36.443832}}}]},Crawler=function(){function Crawler(){Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__["a"])(this,Crawler),this.searchFuncs={},this.loaded_scripts=[]}return Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__["a"])(Crawler,[{key:"init",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return dexie__WEBPACK_IMPORTED_MODULE_8__["a"].debug=!0,n=new dexie__WEBPACK_IMPORTED_MODULE_8__["a"]("mapnote"),e.next=4,n.version(1).stores({subtasks:"id",poitasks:"id,name,province,cityname,fishnetsize,fetched,width,keywords,done,progress,deleted"});case 4:this.db=n;case 5:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"getManyPoiProgress",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n,t){var r,a,l,i,c,o,s,u,d,_;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t*(n-1),e.next=3,this.db.poitasks.offset(r).limit(t).toArray((function(e){return e}));case 3:if(a=e.sent,null==a||void 0==a){e.next=12;break}for(l=[],i=0;i<a.length;i++)c=this.poitask2viewmodel(a[i]),l.push(c);for(o=[],s=0;s<l.length;s++)u=l[s],d=u.progress,_=u.id,o.push({key:_,value:d});return e.abrupt("return",{code:0,data:o,message:"ok"});case 12:return e.abrupt("return",{code:-1,data:null,message:"ok"});case 13:case"end":return e.stop()}}),e,this)})));function n(n,t){return e.apply(this,arguments)}return n}()},{key:"getGeoJson",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=new dexie__WEBPACK_IMPORTED_MODULE_8__["a"](n),t.version(1).stores({pois:"uId"}),r=[],e.next=5,t.pois.toCollection().each((function(e){var n=e.lng,t=e.lat,a={type:"Feature",properties:{uid:e.id,name:e.name,type:e.type,lng:e.lng,lat:e.lat,address:e.address},geometry:{type:"Point",coordinates:[n,t]}};r.push(a)}));case 5:return a={type:"FeatureCollection",features:r},e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"getPoiProgress",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=null,e.next=3,this.db.poitasks.where("id").equalsIgnoreCase(n).first((function(e){return e}));case 3:return r=e.sent,t=r?{code:0,data:this.poitask2viewmodel(r).progress,message:"ok"}:{code:-1,data:-1,message:"ok"},e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"getManyPoiTaskInfo",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n,t){var r,a,l,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t*(n-1),e.next=3,this.db.poitasks.offset(r).limit(t).toArray((function(e){return e}));case 3:if(a=e.sent,null==a||void 0==a){e.next=10;break}for(l=[],i=0;i<a.length;i++)c=this.poitask2viewmodel(a[i]),l.push(c);return e.abrupt("return",{code:0,data:l,message:"ok"});case 10:return e.abrupt("return",{code:-1,data:null,message:"ok"});case 11:case"end":return e.stop()}}),e,this)})));function n(n,t){return e.apply(this,arguments)}return n}()},{key:"poitask2viewmodel",value:function(e){var n=e.current,t=e.current/e.fishnetsize,r={id:e.id,name:e.name,province:e.province,cityName:e.cityname,geoJson:e.geojson,fishNetSize:e.fishnetsize,fetched:n,createtime:e.createtime,width:e.width,keyWords:e.keywords,done:e.done,progress:t,deleted:e.deleted};return r}},{key:"getPoiTaskInfo",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=null,e.next=3,this.db.poitasks.where("id").equalsIgnoreCase(n).first((function(e){return e}));case 3:return r=e.sent,t=r?{code:0,data:this.poitask2viewmodel(r),message:"ok"}:{code:-1,data:null,message:"ok"},e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"crateCrawlTask",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r,a,l,i,c,o,s,u,d,_,h,m,p,f,v;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=n.resources,r=n.searchFncStr,a=n.geojson,l=a.features[0].properties.name,i=a.features[0].properties.parent.name,c=_turf_turf__WEBPACK_IMPORTED_MODULE_10__["bbox"](a),o=.4,s={units:"kilometers"},u=_turf_turf__WEBPACK_IMPORTED_MODULE_10__["squareGrid"](c,o,s),d=[],_=0;_<u.features.length;_++)h=u.features[_],m=_turf_turf__WEBPACK_IMPORTED_MODULE_10__["bbox"](h),d.push([m[0],m[1],m[2],m[3]]);return p=NewGuid(),f={id:p,features:d},v={id:p,name:n.name,province:i,cityname:l,geojson:a,fishnetsize:d.length,createtime:new Date,width:n.width,keywords:n.keywords,done:"false",progress:0,current:0,resources:t,searchFuncStr:r,deleted:"false"},console.log(f),console.log("saved subtasks??"),e.next=18,this.db.poitasks.put(v);case 18:return e.next=20,this.db.subtasks.put(f);case 20:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"tryStartWork",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new dexie__WEBPACK_IMPORTED_MODULE_8__["a"]("mapkey"),e.next=3,n.version(1).stores({amap:"id"});case 3:this.startWork("0971acd2037ad6fda6f8020298651877");case 4:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"startWork",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this,0===Crawler.WorkFlag){e.next=7;break}Crawler.WorkFlag=0,r="https://webapi.amap.com/maps?v=1.4.15&key=".concat(n,"&plugin=AMap.PlaceSearch"),t.loadScripts([r],(function(){t.pubsub()})),e.next=8;break;case 7:return e.abrupt("return");case 8:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"stopWork",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Crawler.WorkFlag=-1;case 1:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()},{key:"randSecnods",value:function(){return 100}},{key:"pubsub",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(){var n,t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getOneSubTask();case 2:n=e.sent,n[0]?this.killsub(n[1]):setTimeout((function(){t.pubsub()}),this.randSecnods());case 4:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"isIntersection",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r,a,l,i,c,o,s,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getMask(n);case 2:t=e.sent,r=t.features,a=_turf_turf__WEBPACK_IMPORTED_MODULE_10__["bboxPolygon"]([n.minlng,n.minlat,n.maxlng,n.maxlat]),l=0,i=0;case 7:if(!(i<r.length)){e.next=24;break}c=r[i],o=0;case 10:if(!(o<c.geometry.coordinates.length)){e.next=19;break}if(s=_turf_turf__WEBPACK_IMPORTED_MODULE_10__["polygon"]([c.geometry.coordinates[o]]),u=_turf_turf__WEBPACK_IMPORTED_MODULE_10__["intersect"](a,s),null===u){e.next=16;break}return l++,e.abrupt("break",19);case 16:o++,e.next=10;break;case 19:if(!(l>0)){e.next=21;break}return e.abrupt("break",24);case 21:i++,e.next=7;break;case 24:if(!(l>0)){e.next=28;break}return e.abrupt("return",!0);case 28:return e.abrupt("return",!1);case 29:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"getResourcesAndEvalScript",value:function(e){return{resources:Crawler.Resources[e],script:Crawler.SearchFuncs[e]}}},{key:"tryLoadResources",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n,t){var r,a,l,i,c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=[],a=document.getElementsByTagName("script"),l=0;l<n.length;l++){for(i=!1,c=0;c<a.length;c++)n[l]===a[c].src&&(i=!0);i||r.push(n[l])}if(r.length<=0)t();else{for(o=0;o<r.length;o++)this.loaded_scripts.push(r[o]);this.loadScripts(r,t)}case 4:case"end":return e.stop()}}),e,this)})));function n(n,t){return e.apply(this,arguments)}return n}()},{key:"try_defineSearchFunc",value:function try_defineSearchFunc(script_str,taskuuid){if(!this.searchFuncs[taskuuid]){var str=script_str+";this.search = search;";eval(str),this.searchFuncs[taskuuid]=!0}}},{key:"search",value:function(e,n,t,r,a){}},{key:"killsub",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return 1===n.idx&&(n.pois=[]),this.currentSub=n,e.next=4,this.isIntersection(n);case 4:if(t=e.sent,t){e.next=9;break}this.continueWorking(!1,!0,null,n),e.next=12;break;case 9:return r=this.getResourcesAndEvalScript(n.taskuuid),e.next=12,this.tryLoadResources(r.resources,(function(){a.try_defineSearchFunc(r.script,n.taskuuid);var e=a.trans2gcj02(n);a.search(e,n.keywords,n.city,n.idx,Crawler.PageSize)}));case 12:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"trans2gcj02",value:function(e){var n=coordtransform__WEBPACK_IMPORTED_MODULE_9___default.a.wgs84togcj02(e.minlng,e.minlat),t=coordtransform__WEBPACK_IMPORTED_MODULE_9___default.a.wgs84togcj02(e.maxlng,e.maxlat);return[n[0],n[1],t[0],t[1]]}},{key:"parseIsLastIdx",value:function(e){if(e.poiList){if(e.poiList.pois.length>0){var n=e.poiList.count,t=e.poiList.pageIndex,r=parseInt(n/Crawler.PageSize)*Crawler.PageSize===n?parseInt(n/Crawler.PageSize):parseInt(n/Crawler.PageSize)+1;return r===t}return!0}return!0}},{key:"tryDeleteTask",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.db.poitasks.where("id").equalsIgnoreCase(n).delete();case 3:return e.next=5,this.db.subtasks.where("id").equalsIgnoreCase(n).delete();case 5:return dexie__WEBPACK_IMPORTED_MODULE_8__["a"].delete(n),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e["catch"](0),console.log(e.t0),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));function n(n){return e.apply(this,arguments)}return n}()},{key:"updatePoiTask",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r,a,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.db.poitasks.where("id").equalsIgnoreCase(n.taskuuid).toArray((function(e){return e}));case 2:if(t=e.sent,!(t.length>0)){e.next=13;break}return r=t[0],a=r.fishnetsize,l=n.positionInSubs+1,l>=a&&(r.done="true"),r.current=l,e.next=11,this.db.poitasks.put(r);case 11:e.next=13;break;case 13:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"parsePOIArr",value:function(e){for(var n=[],t=e.poiList.pois,r=0;r<t.length;r++){var a=t[r],l=a.location.getLng(),i=a.location.getLat(),c=coordtransform__WEBPACK_IMPORTED_MODULE_9___default.a.gcj02towgs84(l,i),o={uId:a.id,name:a.name,type:a.type,lng:c[0],lat:c[1],address:a.address,tel:a.tel};n.push(o)}return n}},{key:"retry",value:function(){var e=this,n=this.currentSub;setTimeout((function(){e.killsub(n)}),this.randSecnods())}},{key:"tryNext",value:function(e,n){var t=this.currentSub;if(null===n||void 0===n)this.commit(t);else if(0===n.length)this.commit(t);else{for(var r=0;r<n.length;r++)t.pois.push(n[r]);e?this.commit(t):(t.idx=t.idx+1,this.killsub(t))}}},{key:"continueWorking",value:function(e,n,t){var r=this,a=this.currentSub;if(e)setTimeout((function(){r.killsub(a)}),this.randSecnods());else if(null===t||void 0===t)this.commit(a);else if(0===t.length)this.commit(a);else{for(var l=0;l<t.length;l++)a.pois.push(t[l]);n?this.commit(a):(a.idx=a.idx+1,this.killsub(a))}}},{key:"getMask",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!Crawler.Masks[n.taskuuid]){e.next=4;break}return e.abrupt("return",Crawler.Masks[n.taskuuid]);case 4:return e.next=6,this.db.poitasks.where("id").equalsIgnoreCase(n.taskuuid).toArray((function(e){return e}));case 6:if(t=e.sent,t){e.next=9;break}return e.abrupt("return",null);case 9:if(!(t.length<=0)){e.next=11;break}return e.abrupt("return",null);case 11:return r=t[0],a=r.geojson,Crawler.Masks[n.taskuuid]=a,e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"commit",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(n.pois.length<=0)){e.next=5;break}return e.next=3,this.updatePoiTask(n);case 3:e.next=11;break;case 5:return t=new dexie__WEBPACK_IMPORTED_MODULE_8__["a"](n.taskuuid),t.version(1).stores({pois:"uId"}),e.next=9,t.pois.bulkPut(n.pois);case 9:return e.next=11,this.updatePoiTask(n);case 11:setTimeout((function(){r.pubsub()}),this.randSecnods());case 12:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"getSubTaskFeatures",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null===Crawler.Features[n.id]||void 0===Crawler.Features[n.id]){e.next=4;break}return e.abrupt("return",Crawler.Features[n.id]);case 4:return e.next=6,this.db.subtasks.where("id").equalsIgnoreCase(n.id).first((function(e){return e}));case 6:return t=e.sent,Crawler.Features[n.id]=t.features,e.abrupt("return",t.features);case 9:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"export2csv",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(n){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=new dexie__WEBPACK_IMPORTED_MODULE_8__["a"](n),t.version(1).stores({pois:"uId"}),r=["Id,名称,类型,经度,纬度,地址"],e.next=5,t.pois.toCollection().each((function(e){var n=e.uId+","+e.name+","+e.type+","+e.lng+","+e.lat+","+e.address;r.push(n)}));case 5:return a=r.join("\n"),console.log("加到的结果是"),console.log(a),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()},{key:"loadScripts",value:function(e,n){var t=function(e,n){var t=document.createElement("script");t.src=e,t.onload=t.onreadystatechange=function(){t.onreadystatechange=t.onload=null,n()};var r=document.getElementsByTagName("head")[0];(r||document.body).appendChild(t)};(function r(){0!=e.length?t(e.shift(),r):n&&n()})()}},{key:"tryInit_resources_scriptStr",value:function(e){Crawler.Resources[e.id]=e.resources,Crawler.SearchFuncs[e.id]=e.searchFuncStr}},{key:"getOneSubTask",value:function(){var e=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(){var n,t,r,a,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.db.poitasks.where("done").notEqual("true").toArray((function(e){return e}));case 2:if(n=e.sent,!(n&&n.length>0)){e.next=14;break}return t=n[0],this.tryInit_resources_scriptStr(t),e.next=8,this.getSubTaskFeatures(t);case 8:return r=e.sent,a=r[t.current],l={taskuuid:t.id,positionInSubs:t.current,idx:1,city:t.cityname,minlng:a[0],minlat:a[1],maxlng:a[2],maxlat:a[3],keywords:t.keywords,done:!1},e.abrupt("return",[!0,l]);case 14:return e.abrupt("return",[!1,null]);case 15:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()}]),Crawler}();Crawler.test=Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(){var n,t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n={name:"test",geojson:testJson,width:400,keywords:"餐饮"},t=new Crawler,t.init().then(Object(E_2020_05_01MapNote_front_end_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.crateCrawlTask(n);case 2:t.startWork("0971acd2037ad6fda6f8020298651877");case 3:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e)}))),Crawler.Features={},Crawler.Masks={},Crawler.WorkFlag=-1,Crawler.PageSize=50,Crawler.Resources={},Crawler.SearchFuncs={},Crawler.create=function(){new Crawler},Crawler.GetPoiTypes=function(){return["汽车服务","汽车销售","汽车维修","摩托车服务","餐饮服务","购物服务","生活服务","体育休闲服务","医疗保健服务","住宿服务","风景名胜","商务住宅","政府机构及社会团体","科教文化服务","交通设施服务","金融保险服务","公司企业","道路附属设施","地名地址信息","公共设施"]},__webpack_exports__["a"]={Crawler:Crawler}},b138:function(e,n,t){e.exports=t.p+"img/yonghutouxiang.c0d12ea2.jpg"},b32a:function(e,n){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAA8ElEQVRIie2VYRGDMAyFkYAEJCABCZWABCTgoBIqAQlIQAISKuHbD5Jb18HIGPzhlrvcFZL3HiSBFIXRgApwQAs0VpyV3AORVwtAeQZ5l5DOwJhcj2cIzELW6xMDdSJSWUhKATWZtwmRy2KT3PcruCYXCJxvIa9z2sR4wHNst1YqbWh4C+6X2QvWf0q6mQDL1zsjUwEMQC9nxzJJ1S8COqZKCjBlue4qgf4vcA8Bd7VAyTL7TULayrmWmP7CTQJakmEzaRsbLAJakvgleclzMbm9ZE2cpCQW1+UT2dvTLBvpiEXtj+WVK2m4N3oP1GtcD1LGPxG4W6JwAAAAAElFTkSuQmCC"},b4e8:function(e,n,t){},c1e1:function(e,n,t){e.exports=t.p+"img/xingqudian.5b3cdcfa.png"},cc16:function(e,n,t){},cd45:function(e,n,t){"use strict";var r=t("7f92"),a=t.n(r);a.a},dc04:function(e,n,t){},de7f:function(e,n,t){},decf:function(e,n,t){e.exports=t.p+"img/dituxuanzeqi.748e5669.png"},e37a:function(e,n,t){}});
//# sourceMappingURL=app.3306a14b.js.map